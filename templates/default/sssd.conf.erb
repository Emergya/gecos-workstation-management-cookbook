[sssd]
config_file_version = 2
domains = <%= @domain.name %>
services = nss, pam, pac
debug_level = 0

[nss]

[pam]

<% if @domain.type == "ad" %>
[domain/<%= @domain.name %>]
# La enumeracion no esta recomendada en entornos con muchos usuarios
cache_credentials=true
enumerate = false

id_provider = ad
auth_provider = ad
chpass_provider = ad
access_provider = ad

override_homedir = /home/%u
<% elsif @domain.type == "ldap" %>
[domain/<%= @domain.name %>]
# La enumeracion no esta recomendada en entornos con muchos usuarios
enumerate = false
cache_credentials = true

id_provider = ldap
auth_provider = ldap

# The client demands unsecure connection :(
ldap_auth_disable_tls_never_use_in_production = True
ldap_uri = <%= @domain.ldap_uri %>
ldap_search_base = <%= @domain.search_base %>

override_homedir = /home/%u
<% end %>
